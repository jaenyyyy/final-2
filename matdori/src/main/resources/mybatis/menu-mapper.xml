<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
    <mapper namespace ="menu">
    
    <insert id="save">
    insert into menu(
    menu_no, res_no, menu_name, menu_price, menu_content) 
    	values(menu_seq.nextval, #{resNo}, #{menuName}, #{menuPrice}, #{menuInfo})
    </insert>
    
    <delete id="deleteByMenuNo">
    delete menu where menu_no=#{menuNo}
    </delete>
    
  <select id="menuListByResNo" resultType="MenuByResDto">
  SELECT 
    menu_no,
    menu_name,
    menu_price,
    menu_content, 
    res_name,
    menu_type_name,
    image_id
  FROM 
    restaurant_menu_with_images
  WHERE 
    res_no = #{resNo}
</select>
    
    <select id = "findByMenuNo" resultType="MenuDto">
    select*from menu where menu_no =#{menuNo}
    </select>
    
    <update id="edit">
    update menu 
    <set>
    <if test="menuDto.menuName != null">
    menu_name = #{menuDto.menuName},
    </if>
    <if test="menuDto.menuPrice != null">
    menu_price = #{menuDto.menuPrice},
    </if>
    <if test="menuDto.menuContent != null">
    menu_content = #{menuDto.menuContent}
    </if>
    </set>
     where menu_no =#{menuNo}
    </update>
    
    </mapper>